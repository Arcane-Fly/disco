{
  "version": "1",
  "packages": {
    "python": "3.12.11",
    "node": "22.11.0"
  },
  "install": [
    {
      "command": "python -m venv /app/.venv",
      "cache": "/app/.venv"
    },
    {
      "command": "source /app/.venv/bin/activate && pip install -r requirements.txt",
      "dependsOn": ["requirements.txt", "pyproject.toml"]
    },
    {
      "command": "npm install --production=false",
      "dependsOn": ["package.json", "package-lock.json"],
      "cache": "node_modules"
    },
    {
      "command": "npm run build:server",
      "dependsOn": ["src/"],
      "output": "dist/"
    },
    {
      "command": "npm run build:next",
      "dependsOn": ["frontend/"],
      "output": "frontend/.next"
    }
  ],
  "deploy": {
    "startCommand": "node /app/dist/server.js",
    "healthcheck": {
      "path": "/health",
      "interval": "30s",
      "timeout": "5s"
    }
  },
  "environment": {
    "NODE_ENV": "production",
    "PYTHON_ENV": "production"
  }
}
